<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:fragment="headerfiles">
<meta charset="UTF-8" />
<title>Jobs Listing</title>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<link rel="stylesheet" media="all" type="text/css"
	th:href="@{/css/style.css}" />
</head>
<body>
	<header th:insert="fragments/general.html :: header"> </header>
	<div th:replace="fragments/general.html :: menu"></div>
	<br>
	<div align="center">
		<span th:if="${session.asession != null}">
		<input type="button" value="Post Jobs"
			onclick="window.location.href='/admin/postjobs'; return false"
			class="btn btn-info btn-lg" /> 
		<input type="button" value="Edit User"
			onclick="window.location.href='/admin/userdetails'; return false"
			class="btn btn-info btn-lg" /> 
		<input type="button" value="Log Out"
			onclick="window.location.href='/admin/logout'; return false"
			class="btn btn-info btn-lg" /> 
		<input type="button" value="Sign Up"
			onclick="window.location.href='/admin/signup'; return false"
			class="btn btn-info btn-lg" />
		</span>
	</div>
	<br>
	<table width="100%" class="center">
		<tr align="center">
			<td width="30%"></td>
			<td align="center" width="40%"><h1
					th:if="${not #lists.isEmpty(jobs)}">Jobs Listing</h1></td>
			<td width="30%"></td>
		</tr>
	</table>
	
	<!-- search bar -->
	<form th:action="@{/job/adminlist}">
		Search: <input type="text" name="keyword" id="keyword" size="50" th:value="${keyword}" required /> &nbsp; 
				<input type="submit" value="Search" /> &nbsp; 
				<input type="button" value="Clear" id="btnClear" onclick="clearSearch()" /> 
		Records per page: 
		<select name="size" onchange="this.form.submit()">
			<option th:unless="${jobs.size == 5}" value="5">5</option>
			<option th:if="${jobs.size == 5}" value="5" selected>5</option>
			<option th:unless="${jobs.size == 10}" value="10">10</option>
			<option th:if="${jobs.size == 10}" value="10" selected>10</option>
			<option th:unless="${jobs.size == 15}" value="15">15</option>
			<option th:if="${jobs.size == 15}" value="15" selected>15</option>
			<option th:unless="${jobs.size == 20}" value="20">20</option>
			<option th:if="${jobs.size == 20}" value="20" selected>20</option>
			<option th:unless="${jobs.size == 25}" value="25">25</option>
			<option th:if="${jobs.size == 25}" value="25" selected>25</option>
		</select>
		Programming Language: 
		<select name="progLang" onchange="this.form.submit()" >
			<option th:if="${lastSelected == ''}" value="" selected>All</option>
			<option th:unless="${lastSelected == ''}" value="">All</option>
			<option th:each="progLang: ${T(sg.edu.iss.jinder.model.ProgLang).values()}" 
					th:value="${progLang}"
					th:text="${progLang}"
					th:selected="${progLang.isSelected(lastSelected)}" >
			</option>
		</select>
	</form>

	<!-- Clear fields -->
	<script type="text/javascript">
    function clearSearch() {
        window.location = "[[@{/job/adminlist(progLang=${lastSelected})}]]";
    }
	</script>

	<!-- Jobs List view -->
	<table class="table table-striped table-hover"
		th:if="${not #lists.isEmpty(jobs)}">
		<thead>
			<tr>
				<th>Job ID</th>
				<th>Company Name</th>
				<th>Job Title</th>
				<th>Job Description</th>
				<th></th>
			</tr>
		</thead>
		<tr th:each="job: ${jobs}" class="table-row">
			<td th:text=${job.id+1}>Id</td>
			<td th:text=${job.companyName}>Name</td>
			<td th:text=${job.jobTitle}>Title</td>
			<td th:if="${#strings.length(job.jobDescription)>50}" th:text="${job.jobDescription.substring(0, 50) + '...'}">Description</td>
			<td th:unless="${#strings.length(job.jobDescription)>50}" th:text="${job.jobDescription}">Description</td>
			<td><span th:if="${session.usession != null}">
					<a href="jobdetail.html" class="btn btn-success"
					th:href="@{/job/detail/}+${job.id}">Click for more details</a>
				</span>
				<span th:if="${session.asession != null}">
					<a href="jobdetail.html" class="btn btn-success"
					th:href="@{/job/admindetail/}+${job.id}">Click for more details</a>
				</span>
			</td>
		</tr>
	</table>
	<div th:if="${jobs.totalPages > 0}" class="pagination">
		<a
			th:href="@{/job/adminlist(size=${jobs.size}, page=1, keyword=${keyword}, progLang=${lastSelected})}"
			th:text="First"></a>
		<a
			th:if="${jobs.totalPages < 5}"
			th:each="pageNumber : ${pageNumbers}"
			th:href="@{/job/adminlist(size=${jobs.size}, page=${pageNumber}, keyword=${keyword}, progLang=${lastSelected})}"
			th:text="' | ' + ${pageNumber} + ' | '"
			th:class="${pageNumber==jobs.number + 1} ? active"></a>
		<a
			th:if="${jobs.number < 2}"
			th:unless="${jobs.totalPages < 5}"
			th:each="pageNumber : ${#numbers.sequence(1, 5)}"
			th:href="@{/job/adminlist(size=${jobs.size}, page=${pageNumber}, keyword=${keyword}, progLang=${lastSelected})}"
			th:text="' | ' + ${pageNumber} + ' | '"
			th:class="${pageNumber==jobs.number + 1} ? active"></a>
		<a
			th:if="${jobs.number >= 2 && jobs.number <= jobs.totalPages-3}"
			th:unless="${jobs.totalPages < 5}"
			th:each="pageNumber : ${#numbers.sequence(jobs.number-1, jobs.number+3)}"
			th:href="@{/job/adminlist(size=${jobs.size}, page=${pageNumber}, keyword=${keyword}, progLang=${lastSelected})}"
			th:text="' | ' + ${pageNumber} + ' | '"
			th:class="${pageNumber==jobs.number + 1} ? active"></a>
		<a
			th:if="${jobs.number > jobs.totalPages-3}"
			th:unless="${jobs.totalPages < 5}"
			th:each="pageNumber : ${#numbers.sequence(jobs.totalPages-4, jobs.totalPages)}"
			th:href="@{/job/adminlist(size=${jobs.size}, page=${pageNumber}, keyword=${keyword}, progLang=${lastSelected})}"
			th:text="' | ' + ${pageNumber} + ' | '"
			th:class="${pageNumber==jobs.number + 1} ? active"></a>
		<a
			th:href="@{/job/adminlist(size=${jobs.size}, page=${jobs.totalPages}, keyword=${keyword}, progLang=${lastSelected})}"
			th:text="Last"></a>
	</div>
	<br>
	<div th:replace="fragments/general.html :: footer"></div>
</body>
</html>